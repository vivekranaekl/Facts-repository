INSERT OVERWRITE TABLE elixir_l1_fact
SELECT elix.`data`.shipmentid AS shipmentid,
       elix.`data`.description AS description,
       elix.`data`.state AS state,
       elix.`data`.partyid AS partyid,
       elix.`data`.formupdate AS formupdate,
       lookup_date(elix.`data`.updatedatetime) AS updatedate_key,
       lookup_time(elix.`data`.updatedatetime) AS updatetime_key,
       elix.`data`.resolution AS resolution,
       lookup_date(elix.`data`.resolutiondatetime) AS resolutiondate_key,
       lookup_time(elix.`data`.resolutiondatetime) AS resolutiontime_key,
       elix.`data`.ticketid AS ticketid,
       elix.`data`.assignedto AS assignedto,
       elix.`data`.partytaskid AS partytaskid,
       lookup_date(elix.`data`.createdatetime) AS createdate_key,
       lookup_time(elix.`data`.createdatetime) AS createtime_key,
       SF.shipment_current_status,
     SF.first_undelivery_status,
     SF.last_undelivery_status,
     SF.payment_type,
     SF.payment_mode,
     SF.ekl_shipment_type,
    SF.shipment_fa_flag,
    SF.fsd_number_of_ofd_attempts,
    SF.source_pincode_key,
    SF.destination_pincode_key,
    SF.customer_misroute_flag,
    SF.rto_create_date_key,
    SF.fsd_assigned_hub_id_key,
    SF.fe_name_key,
	elix.`data`.issuetype,
	elix.`data`.priority,
	elix.`data`.updatedatetime as updatedatetime,
    elix.`data`.resolutiondatetime as resolutiondatetime,
	elix.`data`.createdatetime as createdatetime
FROM bigfoot_journal.dart_fki_scp_ekl_elixirentity_1 elix
left outer join bigfoot_external_neo.scp_ekl__shipment_hive_90_fact SF
on elix.`data`.shipmentid = SF.vendor_tracking_id;