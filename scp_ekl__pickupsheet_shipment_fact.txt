INSERT OVERWRITE TABLE pickupsheet_shipment_fact
Select
tasklist_id,
tasklist_type,
lookupkey('facility_id',facility_id),
lookupkey('vehicle_id',vehicle_id),
lookupkey('agent_id',primary_agent_id),
secondary_agent_id_1,
secondary_agent_id_2,
secondary_agent_id_3,
secondary_agent_id_4,
secondary_agent_id_5,
lookup_date(tasklist_closed_date_time) as tasklist_closed_date_key,
lookup_time(tasklist_closed_date_time) as tasklist_closed_time_key,
lookup_date(tasklist_start_date_time) as tasklist_start_date_key,
lookup_time(tasklist_start_date_time) as tasklist_start_time_key,
lookup_date(tasklist_end_date_time) as tasklist_end_date_key,
lookup_time(tasklist_end_date_time) as tasklist_end_time_key,
tasklist_no_of_shipments_attempted,
lookup_date(tasklist_first_action_date_time) as tasklist_first_action_date_key,
lookup_time(tasklist_first_action_date_time) as tasklist_first_action_time_key,
lookup_date(tasklist_last_action_date_time) as tasklist_last_action_date_key,
lookup_time(tasklist_last_action_date_time) as tasklist_last_action_time_key,
tasklist_pos_id,
tasklist_smart_device_id,
agent_and_date,
vehicle_and_date,
vehicle_type,
lookup_date(tasklist_created_date_time) as tasklist_created_date_key,
lookup_time(tasklist_created_date_time) as tasklist_created_time_key,
vendor_tracking_id,
shipment_actioned_flag,
lookup_date(shipment_pickup_datetime_from_pickupsheet) as shipment_pickup_date_from_pickupsheet_key,
lookup_time(shipment_pickup_datetime_from_pickupsheet) as shipment_pickup_time_from_pickupsheet_key,
shipment_type,
payment_type,
payment_mode,
undelivered_status,
shipment_flash_flag,
adm_flag,
attempt_no,
shipment_item_unit_dispatch_service_tier,
core_fsn_flag,
shipment_lzn_classification,
lookup_date(device_update_time) as device_update_date_key,
lookup_time(device_update_time) as device_update_time_key,
deviceid
from bigfoot_external_neo.scp_ekl__pickupsheet_shipment_map_l1_fact;