INSERT OVERWRITE TABLE tasklist_productivity_fact
select tasklist_created_date_key,
facility_id_key,
tasklist_id,
primary_agent_id_key,
hub_and_date,
shipments_actioned,
shipments_forward_actioned,
shipment_bike_forward_actioned,
shipment_van_forward_actioned,
agent_and_date,
vehicle_and_date,
vehicle_type,
shipment_bike_actioned,
shipment_van_actioned,
tasklist_type,
shipments_attempted,
shipments_forward_attempted,
shipments_bike_forward_attempted,
shipments_bike_attempted,
shipments_van_forward_attempted,
shipments_van_attempted,
tasklist_no_of_shipments_ndd_attempted,
tasklist_no_of_shipments_ndd_forward_attempted,
tasklist_no_of_shipments_ndd_forward_actioned,
tasklist_no_of_shipments_ndd_actioned,
tasklist_no_of_shipments_device_actioned,
tasklist_no_of_shipments_device_attempted,
tasklist_created_time_key,
tasklist_no_of_shipments_cycle_attempted,
tasklist_no_of_shipments_cycle_actioned,
tasklist_no_of_shipments_cycle_forward_attempted,
tasklist_no_of_shipments_cycle_forward_actioned,
vehicle_number,
tasklist_no_of_shipments_sdd_forward_attempted,
tasklist_no_of_shipments_sdd_forward_actioned,
adm_flag,
wave
from(
select distinct
tasklist_created_date_key,
facility_id_key,
tasklist_id,
primary_agent_id_key,
concat(tasklist_created_date_key,'-',facility_id_key) as hub_and_date,
tasklist_no_of_shipments_actioned as shipments_actioned,
tasklist_no_of_shipments_forward_actioned as shipments_forward_actioned,
tasklist_no_of_shipments_bike_forward_actioned as shipment_bike_forward_actioned,
tasklist_no_of_shipments_van_forward_actioned as shipment_van_forward_actioned,
agent_and_date,
vehicle_and_date,
vehicle_type,
tasklist_no_of_shipments_bike_actioned as shipment_bike_actioned,
tasklist_no_of_shipments_van_actioned as shipment_van_actioned,
tasklist_type as tasklist_type,
tasklist_no_of_shipments_attempted as shipments_attempted,
tasklist_no_of_shipments_forward_attempted as shipments_forward_attempted,
tasklist_no_of_shipments_bike_forward_attempted as shipments_bike_forward_attempted,
tasklist_no_of_shipments_bike_attempted as shipments_bike_attempted,
tasklist_no_of_shipments_van_forward_attempted as shipments_van_forward_attempted,
tasklist_no_of_shipments_van_attempted as shipments_van_attempted,
tasklist_no_of_shipments_ndd_attempted,
tasklist_no_of_shipments_ndd_forward_attempted,
tasklist_no_of_shipments_ndd_forward_actioned,
tasklist_no_of_shipments_ndd_actioned,
tasklist_no_of_shipments_device_actioned,
tasklist_no_of_shipments_device_attempted,
tasklist_created_time_key,
tasklist_no_of_shipments_cycle_attempted,
tasklist_no_of_shipments_cycle_actioned,
tasklist_no_of_shipments_cycle_forward_attempted,
tasklist_no_of_shipments_cycle_forward_actioned,
vehicle_number,
tasklist_no_of_shipments_sdd_forward_attempted,
tasklist_no_of_shipments_sdd_forward_actioned,
adm_flag,
wave
from 
bigfoot_external_neo.scp_ekl__ekl_tasklist_hive_fact 
union all
select distinct
tasklist_created_date_key,
facility_id_key,
tasklist_id,
primary_agent_id_key,
concat(tasklist_created_date_key,'-',facility_id_key) as hub_and_date,
tasklist_no_of_shipments_actioned as shipments_actioned,
tasklist_no_of_shipments_forward_actioned as shipments_forward_actioned,
tasklist_no_of_shipments_bike_forward_actioned as shipment_bike_forward_actioned,
tasklist_no_of_shipments_van_forward_actioned as shipment_van_forward_actioned,
agent_and_date,
vehicle_and_date,
vehicle_type,
tasklist_no_of_shipments_bike_actioned as shipment_bike_actioned,
tasklist_no_of_shipments_van_actioned as shipment_van_actioned,
tasklist_type as tasklist_type,
tasklist_no_of_shipments_attempted as shipments_attempted,
tasklist_no_of_shipments_forward_attempted as shipments_forward_attempted,
tasklist_no_of_shipments_bike_forward_attempted as shipments_bike_forward_attempted,
tasklist_no_of_shipments_bike_attempted as shipments_bike_attempted,
tasklist_no_of_shipments_van_forward_attempted as shipments_van_forward_attempted,
tasklist_no_of_shipments_van_attempted as shipments_van_attempted,
tasklist_no_of_shipments_ndd_attempted,
tasklist_no_of_shipments_ndd_forward_attempted,
tasklist_no_of_shipments_ndd_forward_actioned,
tasklist_no_of_shipments_ndd_actioned,
tasklist_no_of_shipments_device_actioned,
tasklist_no_of_shipments_device_attempted,
tasklist_created_time_key,
null as tasklist_no_of_shipments_cycle_attempted,
null as tasklist_no_of_shipments_cycle_actioned,
null as tasklist_no_of_shipments_cycle_forward_attempted,
null as tasklist_no_of_shipments_cycle_forward_actioned,
null as vehicle_number,
null as tasklist_no_of_shipments_sdd_forward_attempted,
null as tasklist_no_of_shipments_sdd_forward_actioned,
adm_flag,
wave
from
bigfoot_external_neo.scp_ekl__ekl_pickupsheet_hive_fact) a;